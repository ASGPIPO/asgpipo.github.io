<!DOCTYPE html>
<html lang="en" style="font-size: 105%">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  
  <meta name="author" content="">

  
  
  <meta name="description" content="跨域与 CORS
1) 什么是跨域
浏览器判断“是否同源/是否跨域（跨源）”只看 协议 &#43; 域名 &#43; 端口（scheme/host/port）。三者任意一个不同，就是跨域。">
  

  
  <link rel="apple-touch-icon" sizes="180x180" href="https://asgpipo.github.io//images/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="https://asgpipo.github.io//images/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="https://asgpipo.github.io//images/favicon-16x16.png">

  
  
  <meta name="keywords" content='hugo latex theme blog texify texify2 texify3 michael neuper'>
  

  
  
  <link rel="stylesheet" href='/katex/katex.min.css'>
<script defer defer src='/katex/katex.min.js'></script>
<script defer src='/katex/contrib/auto-render.min.js'></script>
<script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement(document.body, {
          delimiters: [
              {left: '$$', right: '$$', display: true},
              {left: '$', right: '$', display: false},
              {left: '\\(', right: '\\)', display: false},
              {left: '\\[', right: '\\]', display: true}
          ],
          throwOnError : false
        });
    });
</script>
  

  
  

  
  <meta property="og:url" content="https://asgpipo.github.io/posts/nginx/%E8%B7%A8%E5%9F%9F/">
  <meta property="og:site_name" content="pipo&#39;s site">
  <meta property="og:title" content="跨域">
  <meta property="og:description" content="跨域与 CORS 1) 什么是跨域 浏览器判断“是否同源/是否跨域（跨源）”只看 协议 &#43; 域名 &#43; 端口（scheme/host/port）。三者任意一个不同，就是跨域。">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-12-16T15:07:12+08:00">
    <meta property="article:modified_time" content="2025-12-16T15:07:12+08:00">
    <meta property="article:tag" content="CORS">
    <meta property="article:tag" content="HTTP">
    <meta property="article:tag" content="请求头">


  
  <link rel="canonical" href="https://asgpipo.github.io/posts/nginx/%E8%B7%A8%E5%9F%9F/">

  
  
  
  <meta itemprop="name" content="跨域">
  <meta itemprop="description" content="跨域与 CORS 1) 什么是跨域 浏览器判断“是否同源/是否跨域（跨源）”只看 协议 &#43; 域名 &#43; 端口（scheme/host/port）。三者任意一个不同，就是跨域。">
  <meta itemprop="datePublished" content="2025-12-16T15:07:12+08:00">
  <meta itemprop="dateModified" content="2025-12-16T15:07:12+08:00">
  <meta itemprop="wordCount" content="1219">
  <meta itemprop="keywords" content="CORS,HTTP,请求头">

  
  
  
    <link rel="stylesheet" href="/css/common.min.e562d763c6d0825495eb17de8b2c1d9800cf7c08db1c36accedf77a5fccfc4b9.css" integrity="sha256-5WLXY8bQglSV6xfeiywdmADPfAjbHDaszt93pfzPxLk=" crossorigin="anonymous">
  

  
  
    <link rel="stylesheet" href="/css/content.min.0eb2d1d2ea35e8a94b4208bf1bd8b30a84fc7bc8329a7b795c3db4ed9088ecfb.css" integrity="sha256-DrLR0uo16KlLQgi/G9izCoT8e8gymnt5XD207ZCI7Ps=" crossorigin="anonymous">
  

  
  
  <title>跨域 - pipo&#39;s site</title>
  

  
  
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="跨域">
  <meta name="twitter:description" content="跨域与 CORS 1) 什么是跨域 浏览器判断“是否同源/是否跨域（跨源）”只看 协议 &#43; 域名 &#43; 端口（scheme/host/port）。三者任意一个不同，就是跨域。">


  


  <link rel="stylesheet" href="/css/single.min.be779f459ad7e3aaf8afd0f80c6a61ca6c50993f5f18512532100ac6d93f0fa9.css" integrity="sha256-vnefRZrX46r4r9D4DGphymxQmT9fGFElMhAKxtk/D6k=" crossorigin="anonymous">


  <link rel="stylesheet" href="/css/single.min.78a121b7d7a160420f9daab0ea13add66c37b9c44f27bba07b27207e2b0975d2.css" integrity="sha256-eKEht9ehYEIPnaqw6hOt1mw3ucRPJ7ugeycgfisJddI=" crossorigin="anonymous">


</head>

<body>
  <div id="wrapper">
    


<header id="header">
  <h1>
    <a href="https://asgpipo.github.io/">blog collcetions</a>
    <button id="dark-mode-toggle" class="dark-mode-toggle" aria-label="Toggle theme">
        <svg width="2rem" height="2rem" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 496">
        <path fill="currentColor" d="M8,256C8,393,119,504,256,504S504,393,504,256,393,8,256,8,8,119,8,256ZM256,440V72a184,184,0,0,1,0,368Z" transform="translate(-8 -8)"/>
        </svg>
    </button>
  </h1>

  <nav>
    
    <span class="nav-bar-item">
      
        <span class="icon"><svg width="1em" height="1em" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M17,11H16a1,1,0,0,0,0,2h1a1,1,0,0,0,0-2Zm0,4H16a1,1,0,0,0,0,2h1a1,1,0,0,0,0-2ZM11,9h6a1,1,0,0,0,0-2H11a1,1,0,0,0,0,2ZM21,3H7A1,1,0,0,0,6,4V7H3A1,1,0,0,0,2,8V18a3,3,0,0,0,3,3H18a4,4,0,0,0,4-4V4A1,1,0,0,0,21,3ZM6,18a1,1,0,0,1-2,0V9H6Zm14-1a2,2,0,0,1-2,2H7.82A3,3,0,0,0,8,18V5H20Zm-9-4h1a1,1,0,0,0,0-2H11a1,1,0,0,0,0,2Zm0,4h1a1,1,0,0,0,0-2H11a1,1,0,0,0,0,2Z"/></svg>
</span>
      
      <a class="link" href="/posts/">Blog</a>
    </span>
    
    <span class="nav-bar-item">
      
        <span class="icon"><svg width="1em" height="1em" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M2.88,16.88a3,3,0,0,0,0,4.24,3,3,0,0,0,4.24,0,3,3,0,0,0-4.24-4.24Zm2.83,2.83a1,1,0,0,1-1.42-1.42,1,1,0,0,1,1.42,0A1,1,0,0,1,5.71,19.71ZM5,12a1,1,0,0,0,0,2,5,5,0,0,1,5,5,1,1,0,0,0,2,0,7,7,0,0,0-7-7ZM5,8a1,1,0,0,0,0,2,9,9,0,0,1,9,9,1,1,0,0,0,2,0,11.08,11.08,0,0,0-3.22-7.78A11.08,11.08,0,0,0,5,8Zm10.61.39A15.11,15.11,0,0,0,5,4,1,1,0,0,0,5,6,13,13,0,0,1,18,19a1,1,0,0,0,2,0A15.11,15.11,0,0,0,15.61,8.39Z"/></svg>
</span>
      
      <a class="link" href="/index.xml">RSS</a>
    </span>
    
    <span class="nav-bar-item">
      
        <span class="icon"><svg width="1em" height="1em" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" data-name="Layer 1">
<path d="M10.07031,20.50291a1.00008,1.00008,0,0,0-1.18115-.9834c-1.30908.24024-2.96191.27637-3.40137-.958a5.70754,5.70754,0,0,0-1.83691-2.415,1.20073,1.20073,0,0,1-.1665-.10938,1,1,0,0,0-.93067-.64551H2.54883a.99965.99965,0,0,0-1,.99512c-.00391.81543.811,1.33789,1.1416,1.51465a4.4408,4.4408,0,0,1,.92383,1.35937c.36426,1.02344,1.42285,2.57617,4.46582,2.376.001.03516.00195.06836.00244.09863l.00439.26758a1,1,0,0,0,2,0l-.00488-.31836C10.07715,21.4951,10.07031,21.22068,10.07031,20.50291Zm10.667-15.126c.03174-.125.063-.26367.09034-.41992a6.27792,6.27792,0,0,0-.40821-3.293,1.002,1.002,0,0,0-.61572-.58007c-.356-.12012-1.67041-.35645-4.18408,1.25a13.86918,13.86918,0,0,0-6.354,0C6.76221.751,5.45459.9658,5.10205,1.07908a.99744.99744,0,0,0-.63135.584,6.3003,6.3003,0,0,0-.40332,3.35644c.02442.12793.05078.2461.07813.35449A6.26928,6.26928,0,0,0,2.89014,9.20311a8.42168,8.42168,0,0,0,.04248.92187c.334,4.60254,3.334,5.98438,5.42431,6.459-.04345.125-.083.25878-.11816.40039a1.00023,1.00023,0,0,0,1.94238.47851,1.6784,1.6784,0,0,1,.46778-.87793.99947.99947,0,0,0-.5459-1.74512c-3.4541-.39453-4.95362-1.80175-5.1792-4.89843a6.61076,6.61076,0,0,1-.03369-.73828,4.25769,4.25769,0,0,1,.91943-2.71289,3.022,3.022,0,0,1,.1958-.23145.99988.99988,0,0,0,.188-1.02441,3.3876,3.3876,0,0,1-.15527-.55567A4.09356,4.09356,0,0,1,6.1167,3.06346a7.54263,7.54263,0,0,1,2.415,1.17968,1.00877,1.00877,0,0,0,.82764.13282,11.77716,11.77716,0,0,1,6.17285.001,1.00549,1.00549,0,0,0,.83056-.13769,7.572,7.572,0,0,1,2.40528-1.19043,4.03977,4.03977,0,0,1,.0874,1.57812,3.205,3.205,0,0,1-.16895.60743.9999.9999,0,0,0,.188,1.02441c.07715.08691.1543.18066.22363.26855A4.12186,4.12186,0,0,1,20,9.20311a7.03888,7.03888,0,0,1-.0376.77734c-.22021,3.05566-1.72558,4.46387-5.1958,4.85937a1,1,0,0,0-.54541,1.7461,1.63079,1.63079,0,0,1,.46631.9082,3.06079,3.06079,0,0,1,.09229.81934v2.334C14.77,21.2949,14.77,21.78025,14.77,22.00291a1,1,0,1,0,2,0c0-.2168,0-.69238.00977-1.33984V18.31346a4.8815,4.8815,0,0,0-.15479-1.31153,4.25638,4.25638,0,0,0-.11621-.416,6.51258,6.51258,0,0,0,5.44531-6.42383A8.69677,8.69677,0,0,0,22,9.20311,6.13062,6.13062,0,0,0,20.7373,5.37693Z"/></svg>
</span>
      
      <a class="link" href="https://github.com/ASGPIPO">GitHub</a>
    </span>
    
  </nav>
</header>
<hr class="head-rule"></hr>
    
<main id="main" class="post">
  
  <div class="post-heading">
    <h1 class="post-title">跨域</h1>
    <div class="publish-metadata">
      
      <svg width="0.75em" height="0.75em" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M3 9H21M7 3V5M17 3V5M6 13H8M6 17H8M11 13H13M11 17H13M16 13H18M16 17H18M6.2 21H17.8C18.9201 21 19.4802 21 19.908 20.782C20.2843 20.5903 20.5903 20.2843 20.782 19.908C21 19.4802 21 18.9201 21 17.8V8.2C21 7.07989 21 6.51984 20.782 6.09202C20.5903 5.71569 20.2843 5.40973 19.908 5.21799C19.4802 5 18.9201 5 17.8 5H6.2C5.0799 5 4.51984 5 4.09202 5.21799C3.71569 5.40973 3.40973 5.71569 3.21799 6.09202C3 6.51984 3 7.07989 3 8.2V17.8C3 18.9201 3 19.4802 3.21799 19.908C3.40973 20.2843 3.71569 20.5903 4.09202 20.782C4.51984 21 5.07989 21 6.2 21Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
      16 December 2025
      
      
        &nbsp;
        <span>
          <svg width="0.75em" height="0.75em" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M15.4998 5.49994L18.3282 8.32837M3 20.9997L3.04745 20.6675C3.21536 19.4922 3.29932 18.9045 3.49029 18.3558C3.65975 17.8689 3.89124 17.4059 4.17906 16.9783C4.50341 16.4963 4.92319 16.0765 5.76274 15.237L17.4107 3.58896C18.1918 2.80791 19.4581 2.80791 20.2392 3.58896C21.0202 4.37001 21.0202 5.63634 20.2392 6.41739L8.37744 18.2791C7.61579 19.0408 7.23497 19.4216 6.8012 19.7244C6.41618 19.9932 6.00093 20.2159 5.56398 20.3879C5.07171 20.5817 4.54375 20.6882 3.48793 20.9012L3 20.9997Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          1219 words
        </span>
      
      
      
        
      
      
        &nbsp;
        <span>
          <svg width="0.75em" height="0.75em" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M12 7V12L14.5 13.5M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          ~3 mins
        </span>
      
    </div>
  </div>

  
  <div>
    
    <a class="link tag" href='https://asgpipo.github.io/tags/cors'>#CORS</a>
    
    <a class="link tag" href='https://asgpipo.github.io/tags/http'>#HTTP</a>
    
    <a class="link tag" href='https://asgpipo.github.io/tags/%E8%AF%B7%E6%B1%82%E5%A4%B4'>#请求头</a>
    
    <br></br>
  </div>
  
  
  
  <details>
    <summary>
      <b>Table of Contents</b>
    </summary>
    <div class="toc numbered-subtitles"><nav id="TableOfContents">
  <ul>
    <li><a href="#跨域与-cors">跨域与 CORS</a>
      <ul>
        <li><a href="#1-什么是跨域">1) 什么是跨域</a></li>
        <li><a href="#2-请求头是什么">2) 请求头是什么</a></li>
        <li><a href="#3-cors-把跨域请求分为两类">3) CORS 把跨域请求分为两类</a></li>
      </ul>
    </li>
    <li><a href="#reference">Reference</a></li>
  </ul>
</nav></div>
  </details>
  
  
  <article class="content numbered-subtitles">
    
    <h2 id="跨域与-cors">跨域与 CORS</h2>
<h3 id="1-什么是跨域">1) 什么是跨域</h3>
<p>浏览器判断“是否同源/是否跨域（跨源）”只看 <strong>协议 + 域名 + 端口</strong>（scheme/host/port）。三者任意一个不同，就是跨域。</p>
<ul>
<li><code>http://localhost:8001</code> → <code>http://localhost:8002</code>：跨域（端口不同）</li>
<li><code>http://a.com</code> → <code>https://a.com</code>：跨域（协议不同）</li>
<li><code>http://a.com</code> → <code>http://b.com</code>：跨域（域名不同）</li>
</ul>
<p>注意：<strong>path 不参与跨域判断</strong>。<br>
（同源/CORS 概览）https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS</p>
<hr>
<h3 id="2-请求头是什么">2) 请求头是什么</h3>
<p>HTTP 请求由「请求行 + 请求头(headers) + 空行 + 可选正文(body)」组成。</p>
<ul>
<li><strong class=chinese>请求头</strong>：一堆 <code>Key: Value</code>，描述这次请求的“元信息/上下文”，比如：
<ul>
<li><code>Host</code>：要访问哪个站点（虚拟主机选择相关）</li>
<li><code>Origin</code>：浏览器自动带的“发起请求的源”（跨域时关键）</li>
<li><code>Accept</code>：期望响应的数据类型</li>
<li><code>Content-Type</code>：<strong>请求 body 的格式</strong>（POST/PUT 等常见）</li>
<li><code>Authorization</code>：认证信息（常触发预检）</li>
</ul>
</li>
</ul>
<hr>
<h3 id="3-cors-把跨域请求分为两类">3) CORS 把跨域请求分为两类</h3>
<p>核心区别：<strong>是否需要 preflight（预检 OPTIONS）</strong>。</p>
<h4 id="a-简单请求simple-request">A. 简单请求（simple request）</h4>
<p>跨域情况下满足条件 → 浏览器 <strong class=chinese>直接发送真正请求</strong>，不先发 OPTIONS。</p>
<p>简单请求需要同时满足：</p>
<ol>
<li>方法是：<code>GET</code> / <code>HEAD</code> / <code>POST</code></li>
<li>你在代码里手动设置的请求头属于“安全白名单”（不展开死背，记住：<code>Authorization</code>、自定义 <code>X-*</code> 往往会让它变非简单）</li>
<li>若是 <code>POST</code>，<code>Content-Type</code> 只能是以下三种之一：
<ul>
<li><code>application/x-www-form-urlencoded</code></li>
<li><code>multipart/form-data</code></li>
<li><code>text/plain</code></li>
</ul>
</li>
</ol>
<p>（Simple requests 条件）https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS#simple_requests</p>
<p><strong class=chinese>简单请求的流程</strong></p>
<ol>
<li>浏览器发送真正请求（带 <code>Origin</code>）到跨域服务器</li>
<li>服务器返回响应</li>
<li>浏览器检查响应里是否允许该源读取结果：
<ul>
<li>看 <code>Access-Control-Allow-Origin</code></li>
<li>若允许 → JS 能读到响应</li>
<li>若不允许/缺失 → <strong>请求可能已到后端，但浏览器不让 JS 读取响应</strong>（控制台报 CORS）</li>
</ul>
</li>
</ol>
<p><strong class=chinese>重要纠错</strong>：<code>Access-Control-Allow-Origin</code> 的值只能是：</p>
<ul>
<li><code>*</code> 或者 一个 <strong>origin（协议+域名+端口）</strong>，比如 <code>http://localhost:8001</code><br>
<strong>不能带 path</strong>
<a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Allow-Origin">https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Allow-Origin</a></li>
</ul>
<hr>
<h4 id="b-非简单请求preflighted-request">B. 非简单请求（preflighted request）</h4>
<p>只要不满足简单请求条件（常见原因：<code>Content-Type: application/json</code>、带 <code>Authorization</code>、方法是 PUT/DELETE 等），浏览器通常会：</p>
<p><strong>先发预检 OPTIONS</strong>（preflight），问服务器“我等会儿这样请求行不行？”</p>
<p>预检请求大概长这样：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">OPTIONS /api HTTP/1.1
</span></span><span class="line"><span class="cl">Origin: http://localhost:8001
</span></span><span class="line"><span class="cl">Access-Control-Request-Method: POST
</span></span><span class="line"><span class="cl">Access-Control-Request-Headers: authorization, content-type
</span></span></code></pre></div><p>服务器如果同意，需要在 <strong>OPTIONS 的响应</strong> 里声明允许，例如：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Access-Control-Allow-Origin: http://localhost:8001
</span></span><span class="line"><span class="cl">Access-Control-Allow-Methods: POST
</span></span><span class="line"><span class="cl">Access-Control-Allow-Headers: Authorization, Content-Type
</span></span></code></pre></div><ul>
<li><code>Access-Control-Allow-Headers</code> / <code>Allow-Methods</code> <strong class=chinese>不要求完全一致</strong></li>
<li>只要它们的允许集合 <strong class=chinese>包含</strong> 预检里声明要用的那些即可（集合“超集”覆盖请求即可；从请求角度看就是“请求需求是允许集的子集/真子集”）。<br>
<a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS#preflighted_requests">https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS#preflighted_requests</a></li>
</ul>
<p>通过预检后，浏览器才会发真正请求；预检不通过，真正请求通常不会发出。</p>
<hr>
<h2 id="reference">Reference</h2>
<p><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS">Cross-Origin Resource Sharing (CORS)| MDN</a>
<a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS#preflighted_requests">Preflight 机制| MDN</a>
<a href="https://www.rfc-editor.org/rfc/rfc9110.html">HTTP 报文结构</a><br>
<a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Type">Content-Type</a></p>

    
  </article>

  <button onclick="topFunction()" id="back-to-top" title="Go to top">Back to Top</button>

  

<div id="sharingbuttons">
    
    

    
    

    
    

    
    

    
    

    
    

    
    

    
    
</div>
  <div class="paginator">
    
    <a class="link" href="https://asgpipo.github.io/posts/nginx/location%E5%8C%B9%E9%85%8D/" title="Location匹配">← prev</a>
    
    
    <a class="link" href="https://asgpipo.github.io/posts/java/java_base/io/java-%E5%9F%BA%E7%A1%80-io/" title="Java基础IO">next →</a>
    
  </div>
  <div class="comment">
    
    
    
      <script src="https://giscus.app/client.js"
        data-repo="michaelneuper/website"
        data-repo-id="R_kgDOIjPNaQ"
        data-category="General"
        data-category-id="DIC_kwDOIjPNac4CaklA"
        data-mapping="pathname"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="top"
        data-theme="gruvbox"
        data-lang="en"
        data-loading="lazy"
        crossorigin="anonymous"
        async>
  </script>
  
  </div>
  
  
</main>

    <footer id="footer">
  <div>
    <span>Powered by  <a class=link href=https://gohugo.io target=_blank rel=noopener>Hugo</a> | 
Theme <a class=link href=https://github.com/michaelneuper/hugo-texify3 target=_blank rel=noopener>TeXify3</a>
</span>
  </div>
  <div>
    <span>Copyright © 2025 </span>
  </div>
</footer>

  </div>

  
  <script src='https://asgpipo.github.io/js/script.js' defer></script>

  
  
  <link media="screen" rel="stylesheet" href="https://asgpipo.github.io/css/syntax.css" />
  
  <link media="screen" rel="stylesheet" href="https://asgpipo.github.io/css/scale.css" />
  

  
  

  
  

</body>

</html>
